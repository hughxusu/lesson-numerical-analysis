# 正交多项式

设函数$f(x)$是区间$[a,b]$上的连续函数，对于任意给定$\forall \epsilon \ge 0$，如果存在多项式$P(x)$，使得不等式
$$
\max_{a\le x \le b} \left | f(x)-P(x) \right | < \epsilon
$$
成立，则称$P(x)$在区间$[a,b]$上一致逼近（或均匀逼近）于函数$f(x)$。

> [!warning]
>
> 上面的范数实际上是函数$g(x)=f(x)-P(x) $的范数，而不是直接定义在两个函数上的范数。

对于$f(x)\in C[a,b]$，求多项式$P_n^*(x)\in H_n$，$H_n$代表全体多项式构成的结合，使得误差
$$
\left \| f(x)-P^*_n(x) \right \|=\min_{P_n\in H_n} \left \| f(x)-P_n(x) \right \|
$$
则称$P_n^*(x)$为$f(x)$在$[a, b]$上的最佳逼近多项式。

最佳逼近多项式的三重含义：

1. 一个连续函数$f(x)$定义在区间$[a, b]$上，希望用一个多项式$P_n(x)$来近似这个函数。选择一个选择一个多项式集合$H_n$，作为逼近空间。
1. $f(x)$和$P_n(x)$的差异用范数来描述，可以是2-范数、无穷范数等。
1. 在所有满足$P_n\in H_n$的多项式中，希望找到一个多项式$P^*_n(x)$使得误差最小，这个$P^*_n(x)$就是最佳逼近。

> [!warning]
>
> 在函数逼近问题中，正交多项式起到了构造最佳逼近多项式、降低数值误差以及提高计算稳定性的作用。

## 正交多项式的概念

若$f(x),g(x)\in C[a,b]$，且
$$
\left(f(x),g(x)\right)=\int_{b}^{a}f(x)g(x)\mathrm{d}x=0
$$
则称$f(x)$和$g(x)$在$[a,b]$上正交。

若函数$\varphi_0(x),\varphi_1(x),……,\varphi_n(x)$满足关系
$$
(\varphi_j(x),\varphi_k(x))
=\int_{b}^{a}\varphi_j(x)\varphi_k(x)\mathrm{d}x
=
\left\{\begin{matrix}
0 & j\ne k\\
A_k>0 & j=k
\end{matrix}\right.
$$
则称$\left \{ \varphi_k(x)\right \} $是$[a,b]$上的正交函数系。若$A_k\equiv 0$，则称为标准正交函数系。

若$f(x),g(x)\in C[a,b]$，$w(x)$是$[a,b]$上的权函数且满足
$$
\left(f(x),g(x)\right)=\int_{b}^{a}w(x)f(x)g(x)\mathrm{d}x=0
$$
则称$f(x)$与$g(x)$在$[a,b]$上带权$w(x)$正交。

若函数$\varphi_0(x),\varphi_1(x),……,\varphi_n(x)$满足关系
$$
(\varphi_j(x),\varphi_k(x))
=\int_{b}^{a}w(x)\varphi_j(x)\varphi_k(x)\mathrm{d}x
=
\left\{\begin{matrix}
0 & j\ne k\\
A_k>0 & j=k
\end{matrix}\right.
$$
则称$\left \{ \varphi_k(x)\right \} $是$[a,b]$上带权$w(x)$的正交函数系。若$A_k\equiv 0$，则称为标准正交函数系。

例如：三角函数族
$$
1,\cos x,\sin x, \cos 2x, \sin 2x …
$$
为$[-\pi, \pi]$上的正交函数族。

1. 任意两个不同函数在$[-\pi, \pi]$上积分为0。根据积化和差公式可以证明

$$
\begin{array}{lll} 
\int_{-\pi}^{\pi}\cos nx\mathrm{d}x=0 \\
\int_{-\pi}^{\pi}\sin nx\mathrm{d}x=0 \\
\int_{-\pi}^{\pi}\cos mx\sin nx\mathrm{d}x=0 \\
\int_{-\pi}^{\pi}\cos mx\cos nx\mathrm{d}x=0 \\
\int_{-\pi}^{\pi}\sin mx\sin nx\mathrm{d}x=0 \\
\end{array}
$$

2. 任意两个相同函数$[-\pi, \pi]$上积分为$\pi$

$$
\begin{array}{lll} 
\int_{-\pi}^{\pi}\cos m\cos n\pi\mathrm{d}x=
\left\{\begin{matrix}
0 & m \ne n \\
\pi & m = n
\end{matrix}\right.
\\
\int_{-\pi}^{\pi}\sin m\sin n\pi\mathrm{d}x=
\left\{\begin{matrix}
0 & m \ne n \\
\pi & m = n
\end{matrix}\right.
\end{array} 
$$

所以有
$$
\begin{array}{lll} 
(1, 1)=2\pi \\
(\cos kx, \cos kx)=(\sin kx, \sin kx)=\pi  \\
\text{其他=0} 
\end{array} 
$$
> [!warning]
>
> 区间$[a,b]$上的正交函数系必定线性无关

## 正交多项式的构造

给定区间$[a,b]$及权函数$w(x)$，均由一族线性无关的幂函数${1, x, …, x^n}$，利用逐个正交化手续立得正交多项式序列
$$
\begin{array}{lll} 
\varphi_0(x)=1  \\
\varphi_n(x)=
x^n-\sum_{j=0}^{n-1}\frac{(x^n,\varphi_j(x))}{(\varphi_j(x),\varphi_j(x))}\varphi_j(x) & n=1,2,… 
\end{array}
$$

> [!warning]
>
> 可以理解为从一组简单的幂函数出发，通过逐步去除它们之间的“重叠部分”（即投影），构造出一组在给定权函数下彼此正交的多项式。

当$[a,b]=[0,1]$时可以构造正交多项式如下
$$
\begin{array}{lll} 
\varphi_0(x)=1 \\ 
\varphi_1(x)=x-\frac{(x,1)}{(1,1)} =x-\frac{1}{2} \\
\varphi_2(x)=
x^2-\frac{(x,1)}{(1,1)}\times 1-
\frac{(x^2,x-\frac{1}{2})}{(x-\frac{1}{2},x-\frac{1}{2})}(x-\frac{1}{2})=x^2-x+\frac{1}{6} 
\end{array}
$$
性质

1. $\left \{ \varphi_0(x),\varphi_1(x),……,\varphi_n(x) \right \} $线性无关。
2. 对$\forall P_n(x)\in H_n$均可表示为$\varphi_0(x),\varphi_1(x),……,\varphi_n(x)$的线性组合。
3. 当$k\ne j$时，$(p_j,p_k)=0$且$p_k(x)$与任一次小于k的多项式正交。
4. 递推关系成立

$$
\varphi_{n+1}(x)=(x-\alpha_n)\varphi_{n}(x)-\beta_n\varphi_{n-1}(x) \quad n=1,2,…
$$

其中
$$
\begin{array}{lll} 
\varphi_0(x)=1, \quad  \varphi_{-1}(x)=0 \\
\alpha_n=\frac{(x\varphi_n(x),\varphi_n(x))}{(\varphi_n(x),\varphi_n(x))} \\
\beta_n=\frac{(\varphi_n(x),\varphi_n(x))}{(\varphi_{n-1}(x),\varphi_{n-1}(x))}
\end{array}
$$

5. $\varphi_n(x)$在$[a,b]$内有$n$个单重实根。

使用程序构造正交多项式

```python
import sympy as sp

def gram_schmidt_orthogonalization(n, a, b, w):
    x = sp.Symbol('x')
    basis = [x**i for i in range(n+1)]  # 幂函数 {1, x, x^2, ..., x^n}
    ortho_poly = []
    
    def inner_product(f, g):
        return sp.integrate(f * g * w, (x, a, b))
    
    for i in range(n+1):
        phi_i = basis[i]
        for phi_j in ortho_poly:
            coeff = inner_product(basis[i], phi_j) / inner_product(phi_j, phi_j)
            phi_i -= coeff * phi_j
        ortho_poly.append(sp.simplify(phi_i))
    
    return ortho_poly

a, b = 0, 1  # 定义区间
w = 1  # 权函数 w(x) = 1
n = 6  # 计算到 x^3 的正交多项式

ortho_polynomials = gram_schmidt_orthogonalization(n, a, b, w)

for i, poly in enumerate(ortho_polynomials):
    print(f'ϕ_{i}(x) = {poly}')
```

绘制上面多项式图像

```python
import matplotlib.pyplot as plt

plt.figure()
x_vals = np.linspace(a, b, 400)
for i, poly in enumerate(ortho_polynomials):
    if i == 0:
        continue
    numpy_func = sp.lambdify(x, poly, modules=['numpy', 'scipy'])
    y_vals = numpy_func(x_vals)
    plt.plot(x_vals, y_vals,  label=fr'$\phi_{i}(x)$')

plt.title(f'Orthogonal Polynomials on [{a}, {b}] with $w(x) = {w}$', fontsize=14)
plt.xlabel('x', fontsize=12)
plt.ylabel('ϕ(x)', fontsize=12)
plt.grid(True, linestyle='--', alpha=0.7)
plt.legend(loc='upper left', fontsize=10)
plt.show()
```

## 常用的正交多项式系

### 勒让德多项式

当$[a,b]=[-1,1]$，权函数$w(x)\equiv1$时，由${1, x, …, x^n}$正交化得到的多项式为式勒让德多项式。

* 专用符号$P_0(x),P_1(x),…,P_n(x)$。

* 罗德里格公式为

$$
P_n(x)=
\frac{1}{2^nn!}\cdot
\frac{\mathrm{d}^n }{\mathrm{d} x^n}\left [ \left (x^2-1\right )^n\right],
\quad n=0,1,2,…
$$

​	其首项系数为
$$
a_n=
\frac{2n(2n-1)…(n-1)}{2^nn!}=
\frac{(2n)!}{2^n(n!)^2}
$$
首项系数为$1$的勒让德多项式为
$$
\tilde{P}_n(x)=
\frac{n!}{(2n)!}\cdot 
\frac{\mathrm{d}^n }{\mathrm{d} x^n}\left [ \left (x^2-1\right )^n\right],
\quad n=0,1,2,…
$$
勒让德多项式的性质

1. 正交性

$$
\int_{-1}^{1}P_n(x)P_m(x)dx=
\left\{\begin{matrix}
0  & m\ne n \\
\frac{2}{2n+1} & m=n
\end{matrix}\right.
$$

2. 奇偶性

$$
P_n(-x)=(-1)^nP_n(x)
$$

3. $P_n(x)$在$(-1, 1)$内部有$n$个互异的实零点。

4. 递推关系式

$$
\left\{\begin{matrix}
P_0(x)=1, \quad P_1(x)=x \\
P_{n+1}(x)=\frac{2n+1}{n+1}xP_n(x)-\frac{n}{n+1} P_{n-1}
\end{matrix}\right.
\qquad n=1, 2, …
$$

根据递推公式可得
$$
\begin{array}{lll} 
P_2(x)=\frac{1}{2}(3x^2-1)  \\
P_3(x)=\frac{1}{2}(5x^3-3x) 
\end{array}
$$

### 切比雪夫多项式

当$[a,b]=[-1,1]$，权函数
$$
w(x)=\frac{1}{\sqrt{1-x^2}}
$$
时，由${1, x, …, x^n}$正交化得到的多项式为式切比雪夫多项式，专用符号$T_0(x),T_1(x),…,T_n(x)$。它可表示为
$$
T_n(x)=\cos(n\arccos x),\quad -1\le x \le 1, \quad n=0,1,2,…
$$
若令$x=\cos\theta$，则$T_n(x)=\cos(n\theta)$，$0\le\theta \le \pi $，利用多倍角公式
$$
\begin{array}{lll} 
T_0(x)=\cos(0)=1 \\
T_1(x)=\cos(\arccos x)=\cos\theta=x \\
T_2(x)=\cos(2\arccos x)=\cos2\theta=2\cos\theta^2-1=2x^2-1 \\
T_3(x)=4x^3-3x \\
…
\end{array}
$$
