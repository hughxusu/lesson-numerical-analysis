# 样条插值

> [!Note]
>
> 几种插值法的问题
>
> 1. 多项式插值，确定唯一的高阶多项式，但有可能有龙格线性。
> 1. 分段低次插值，分段点无法连续可导。

样条插值中的“样条”源于工程制图中使用的物理样条（如弹性木条或金属条），这些工具被固定在关键点之间自然弯曲形成光滑曲线。样条函数就是对这样的曲线进行的数学模拟得到的。

<img src="../_images/Spline_(PSF).png" style="zoom: 20%;" />

##  样条函数的概念

设$S(x)$是区间$[a, b]$上函数，在区间$[a, b]$上给定一组基点
$$
a=x_0<x_1<x_2<…<x_n=b
$$
若函数$S(x)$满足条件：

1. $S(x)$在每个子区间$[x_i, x_{i+1}]$，$i=1, 2, …, n-1$上是次数不超过$m$的多项式；
2. $S(x)$在区间$[a, b]$上有$m-1$阶连续导数；

则称$S(x)$是定义在区间$[a, b]$上的$m$次样条函数。$x_0,x_1,x_2,…$称为样条节点，其中$x_1,…,x_{n-1}$称为内节点，$x_0, x_n$称为边界节点。当$m=3$时，便成为最常用的三次样条函数。

> [!warning]
>
> 样条函数是一个分段函数，且样条函数在各个分段之间具有一定的**平滑性**要求。

### 三次样条插值

设$y=f(x)$在点
$$
a=x_0,x_1,x_2,…,x_n=b
$$
的值为$y_0,y_1,y_2,…,y_n$，若函数$S(x)$满足下列条件：

1. $S(x_i)=f(x_i)=y_i$，$i=1, 2, …, n-1$。
2. 在每个子区间$[x_i, x_{i+1}]$，$i=1, 2, …, n-1$上$S(x)$是三次多项式
3. $S(x)$在$[a, b]$上二阶连续可微。

则称$S(x)$为函数$f(x)$的三次样条插值函数。

### 构造方法

$S(x)$除了满足基本样条插值条件$S(x_i)=f(x_i)$外还应具有如下形式
$$
S(x)=\left\{\begin{matrix}
S_0(x)  & x \in[x_0, x_1] \\
S_1(x)  & x \in[x_1, x_2] \\
… & \\
S_{n-1}(x) & x \in[x_{n-1}, x_n]
\end{matrix}\right.
\qquad 
S_i(x) \in F_3\left ( [x_i, x_{i+1}] \right )
$$
并且满足条件
$$
\left\{\begin{matrix}
S_{i-1}(x_i)=S_i(x_i) & i=1,2,…,n-1 \\
{S}'_{i-1}(x_i)={S}'_i(x_i)  & i=1,2,…,n-1 \\
{S}''_{i-1}(x_i)={S}''_i(x_i) & i=1,2,…,n-1
\end{matrix}\right.
$$
设函数
$$
S(x)=S_i(x)=a_i+b_ix+c_ix^2+d_ix^3, \quad x \in [x_i, x_{i+1}]
$$
其中$i=1, 2, …, n-1$，其中有$4n$个待定系数
$$
\left \{ a_j \right \},\left \{ b_j \right \},
\left \{ c_j \right \},\left \{ d_j \right \}
\quad 
i=1,2,…,n-1
$$
$S(x)$共需$4n$个独立条件确定。

1. 内部光滑条件

$$
\left\{\begin{matrix}
S_{i-1}(x_i)=S_i(x_i) & i=1,2,…,n-1 \\
{S}'_{i-1}(x_i)={S}'_i(x_i)  & i=1,2,…,n-1 \\
{S}''_{i-1}(x_i)={S}''_i(x_i) & i=1,2,…,n-1
\end{matrix}\right.
$$

$3(n-1)$个。

2. 插值条件

$$
S(x_i)=f(x_i) \quad i=0,1, 2, …, n
$$

$n+1$独立条件。共有方程$4n-2$

> [!warning]
>
> 这里有$4n$个待定系数，有$4n-2$个方程，所以一定存在函数$S(x)$。

如果希望函数$S(x)$唯一确定需要再增加两个条件方程，附加条件有多种形式。

附件条件一般在边界处增加，常用的三种边界条件

1. 第一种边界条件

$$
{S}''(x_0)={f}''(x_0)=M_0, \quad {S}''(x_n)={f}''(x_n)=M_n
$$

特别的$M_0=M_n=0$为自然边界条件。

2. 第二种边界条件

$$
{S}'(x_0)={f}'(x_0)=m_0, \quad {S}'(x_n)={f}'(x_n)=m_n
$$

3. 第三种边界条件（周期边界条件），$y=f(x)$为周期函数，要求$S(x)$也为周期函数，周期变为$b-a$，即取

$$
S^{(k)}(x_0)=S^{(k)}(x_n), \quad k=0, 1, 2
$$

此时称$S(x)$为周期样条函数。



