# 牛顿插值

## 差商

定义
$$
f[x_i, x_j]=\frac{f(x_i)-f(x_j)}{x_j-x_i}
$$
为函数关于点$x_i, x_j$的一阶差商。

> [!warning]
>
> 导数就是差商取极限

二阶差商
$$
f[x_i, x_j, x_k]=\frac{f[x_i, x_j]-f[x_i, x_j]}{x_k-x_j}
$$
一般地
$$
f[x_0, x_1, …,x_k]
=\frac{f[x_0, …, x_{k-2}, x_k]-f[x_0, x_1, …,x_{k-1}]}{x_k-x_{k-1}}
$$
为$f(x)$在$k+1$个点$x_0, x_1, …,x_k$的$K$阶差商（也称均差）。

差商的记号
$$
f[x_i]=f(x_i) \quad i=0, 1, …,n
$$
表示0阶差商。

> [!warning]
>
> 0阶差商定义为该点的函数值，是构建高阶差商的基础。

一阶差商
$$
f[x_0, x_1] = \frac{f[x_1]-f[x_0]}{x_1-x_0}
$$
二级差商
$$
f[x_0, x_1, x_2]=\frac{f[x_0, x_2]-f[x_0, x_1]}{x_2-x_1}
=\frac{\frac{f_2-f_0}{x_2-x_0}-\frac{f_1-f_0}{x_1-x_0} }{x_2-x_1}
$$

### 差商的性质

1. 差商具有线性。

若$f(x)=k_1g_1(x)+k_2g_2(x)$，则
$$
f[x_0, x_1, …, x_k]=k_1g_1[x_0, x_1, …,x_k]+k_2g_2[x_0, x_1, …,x_k]
$$

2. 差商可以表示为函数值的线性组合

$$
\begin{aligned}
f[x_0, x_1, …,x_k] & =\sum_{j=0,j\ne i}^{k}\frac{f(x_j)}{(x_j-x_0)…(x_j-x_{j-1})(x_j-x_{j+1})…(x_j-x_k)} \\
&=\sum_{j=0}^{k}\frac{f(x_j) }{{\omega}'_{k+1}(x_j) } 
\end{aligned}
$$

其中函数$\omega(x)$是连乘形式。

假设$k=2$时
$$
\begin{aligned}
f[x_0, x_1, x_2] 
&=\frac{f[x_0, x_2]-f[x_0, x_1]}{x_2-x_1}  \\
&=\frac{\frac{f_2-f_0}{x_2-x_0}-\frac{f_1-f_0}{x_1-x_0} }{x_2-x_1} \\
&=\frac{f[x_0]}{(x_0-x_1)(x_0-x_2)}+\frac{f[x_1]}{(x_1-x_0)(x_1-x_2)}+\frac{f[x_2]}{(x_2-x_0)(x_2-x_1)} \\
&=a_0f(x_0)+a_1f(x_1)+a_2f(x_2)
\end{aligned}
$$
其中
$$
a_0=\frac{1}{(x_0-x_1)(x_0-x_2)}=\frac{1}{{\omega}'_3(x_0)  }  \\
a_1=\frac{1}{(x_1-x_0)(x_1-x_2)}=\frac{1}{{\omega}'_3(x_1)  }  \\
a_2=\frac{1}{(x_2-x_0)(x_2-x_a)}=\frac{1}{{\omega}'_3(x_2)  }  \\
$$

> [!warning]
>
> 教材中用数学归纳法证明。

3. 差商与所含节点的顺序无关

$$
f[x_0, x_1, …,x_k] = f[ x_1, x_0, …,x_k] = f[ x_1, …,x_k, x_0]
$$

4. 差商还可表示为

$$
f[x_0, x_1, …,x_k]
=\frac{f[x_1, …, x_{k-1}, x_k]-f[x_0, x_1, …,x_{k-1}]}{x_k-x_0}
$$

5. 如果$f(x)$在含有$x_0, x_1, …,x_n$的区间$[a,b]$上具有$n$阶导数，则在此区间内至少有一$\xi$使得

$$
f[x_0, x_1, …,x_k]= \frac{f^{(n)}(\xi)}{n!}
$$

## 牛顿插值多项式













