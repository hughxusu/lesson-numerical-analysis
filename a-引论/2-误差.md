# 计算的误差

数值分析主要的对象是数值，数值的计算都是近似的，计算一定存在误差。

绝对误差：$x$代表真值，$x^*$代表近似值，$e=x-x^*$称为绝对误差，简称误差。

> [!warning]
>
> 在数值分析研究中真值是不存在的。

$$
e=x-x^*=\left\{\begin{matrix}
 < 0 & \text{强近似值} \\
 > 0 & \text{弱近似值}
\end{matrix}\right.
$$

由于真值找不到，主要研究的对象转化为
$$
\left | e \right | = \left | x-x^* \right | \le  \epsilon
$$
$\epsilon$称为绝对误差限，简称误差限。这个误差限可以通过理论推导求得。误差限还可表示为
$$
x^*- \epsilon \le x \le x^*+ \epsilon\quad \text{or} \quad x=x^*\pm \epsilon
$$

> [!warning]
>
> 误差限不是唯一存在，但是有精确度的区别。

例如，线性方程组及其系数保留两位有效数字，形式如下：
$$
\left\{\begin{matrix}
x_1+\frac{1}{2} x_2+\frac{1}{3} x_3 = \frac{11}{6}\\
\frac{1}{2}x_1+\frac{1}{3} x_2+\frac{1}{4} x_3 = \frac{13}{12} \\
\frac{1}{3}x_1+\frac{1}{4} x_2+\frac{1}{5} x_3 = \frac{47}{60}
\end{matrix}\right.
\Rrightarrow
\left\{\begin{matrix}
x_1+0.5x_2+0.33x_3 = 1.8\\
0.5x_1+0.33x_2+0.25x_3 =1.1 \\
0.33x_1+0.25x_2+0.2 x_3 = 0.78
\end{matrix}\right.
$$
方程组的准确解为
$$
x_1=x_2=x_3=1
$$
方程的近似解为
$$
x_1=-6.22…,\quad x_2= 38.25…, \quad x_3= -33.65…
$$
使用Python程序模拟上述过程，方程组计算如下

```python
import numpy as np

A = np.array([[1, 1/2, 1/3],
              [1/2, 1/3, 1/4],
              [1/3, 1/4, 1/5]])
b = np.array([11/6, 13/12, 47/60])
# 使用NumPy的线性方程求解方法
x = np.linalg.solve(A, b)
print("解为 x1, x2, x3:", x)
```

近似方程组计算如下

```python
A = np.array([[1, 0.5, 0.33],
              [0.5, 0.33, 0.25],
              [0.33, 0.25, 0.2]])
b = np.array([1.8, 1.1, 0.78])

x = np.linalg.solve(A, b)
print("近似解为 x1, x2, x3:", x)
```

## 相对误差

相对误差可以表示为
$$
e_r=\frac{e}{x}=\frac{x-x^*}{x}
$$
但是由于真值无法获得，所以可以表示为
$$
e_r=\frac{e}{x^*}=\frac{x-x^*}{x^*}
$$
这个误差称为相对误差。相对误差限可表示为
$$
\left | e_r \right | = \left | \frac{e}{x^*} \right | = \left | \frac{x-x^* }{x^*} \right | \le  \epsilon_r
$$
函数值的绝对误差
$$
e\left | f(x) \right | = {f}'(x)e(x)={f}'(x)(x-x^*)\approx \mathrm{d}f(x)
$$
函数的误差近似等于其微分。

> [!note]
>
> 两个同学，一个150分满分考了139，另一个100分满分考了90。两者的绝对误差分别为11和10，优劣如何。

同学一，相对误差
$$
\frac{150-139}{150}\approx0.073
$$
同学二，相对误差
$$
\frac{100-90}{100}=0.1
$$
相对误差的意义：

1. 相对误差比绝对误差更能反映准确值与近似值之间的差异。
2. 绝对误差和相对误差有无穷多，自然越小越好。
3. 误差估计的任务就是提供好的误差限，误差限越小，数据越准确可靠。

> [!note]
>
> 设$S=\frac{1}{2}gt^2$，假设$g$是准确的，而对$t$的测量有$\pm0.1$秒的误差，证明当$t$增加时$S$的绝对误差增加，而相对误差减小。

绝对误差
$$
e(S)=S^*-S=\frac{1}{2}g{t^*}^2-\frac{1}{2}gt^2=0.1gt
$$
相对误差
$$
e_t(S)=\frac{e(S)}{\frac{1}{2}gt^2}=\frac{0.1gt}{\frac{1}{2}gt^2}=\frac{0.2}{t}
$$
所以有
$$
t\uparrow \Rightarrow \left\{\begin{matrix}
e(S)\uparrow \\
e_r(S)\downarrow 
\end{matrix}\right.
$$

> [!note]
>
> 函数值的相对误差限
> $$
> e_r\left | f(x) \right | = \left | \frac{e(f(x))}{f(x)}  \right | = \left | \frac{{f}'(x)e(x)}{f(x)}  \right |
> $$
> 计算球体积要使相对误差限为$1\%$，问度量半径为$R$时，允许的相对误差限时多少？

球的体积公式
$$
V(R)=\frac{4}{3}\pi R^3
$$
相对误差限为
$$
e_r\left | V(R) \right |  = \left | \frac{{f}'(x)e(x)}{f(x)}  \right |= \left | \frac{4\pi R x^2e(x)}{\frac{4}{3}\pi R^3}  \right |=3\left | \frac{e(R)}{R}\right |=3\left | e_r(R)\right |
$$
