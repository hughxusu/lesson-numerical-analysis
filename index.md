2. 插值法
   1. 引言
   2. 拉格朗日插值
   3. 差商与牛顿插值多项式
   4. 埃尔米特插值
   5. 分段低次插值
   6. 样条插值





\```ys_think <icon>https://wy-static.wenxiaobai.com/bot-capability/prod/%E6%B7%B1%E5%BA%A6%E6%80%9D%E8%80%83.png</icon> <start>思考中...</start> 好的，我现在需要帮学生理解为什么在区间$[x_k, x_{k+1}]$内，函数$(x - x_k)(x - x_{k+1})$的绝对值的最大值是$\frac{h^2}{4}$。学生可能对这一步的推导不太清楚，我应该详细解释这个过程。 首先，学生可能已经知道分段线性插值的余项表达式，但具体到这个二次项的极值问题，可能不太明白如何找到最大值。我需要从基础开始，逐步引导他们理解。 首先，明确区间长度为$h = x_{k+1} - x_k$，所以区间内的任意点$x$可以表示为$x = x_k + th$，其中$t$在$[0, 1]$之间。这样替换变量可能更直观，将问题转化为关于$t$的函数来分析。 接下来，将原式$(x - x_k)(x - x_{k+1})$用变量$t$表示。代入$x = x_k + th$，则$x - x_k = th$，而$x_{k+1} - x = h - th = h(1 - t)$。不过这里原式是$(x - x_k)(x - x_{k+1})$，所以需要注意符号。当展开时，应该是$(x - x_k)(x - x_{k+1}) = (th)(x_k + th - x_{k+1})$。但可能更简单的方法是将$x_{k+1} = x_k + h$代入，所以原式变为： $(x - x_k)(x - (x_k + h)) = (x - x_k)(x - x_k - h)$. 令$d = x - x_k$，则表达式变为$d(d - h) = d^2 - h d$，这是一个关于$d$的二次函数，开口向上，顶点在$d = h/2$处。但此时$d$的范围是0到h，所以在区间$d \in [0, h]$内，这个二次函数的最大绝对值出现在端点还是顶点？ 或者，或许更直接的方式是使用变量替换法，将区间标准化到$t \in [0,1]$，然后找到函数的最大绝对值。例如，令$t = (x - x_k)/h$，则$x = x_k + th$，其中$t \in [0,1]$。那么表达式变为： $(x - x_k)(x - x_{k+1}) = (th)(th - h) = th(th - h) = h^2 t(t - 1)$. 这样，绝对值就是$h^2 |t(t - 1)|$。现在问题转化为在$t \in [0,1]$时，求$|t(t - 1)|的最大值。 这里，函数$g(t) = t(t - 1) = t^2 - t$，在区间$t \in [0,1]$内。求其绝对值的最大值。首先找到g(t)的极值点，导数g’(t)=2t -1，令导数为0，得t=1/2。此时g(1/2) = (1/2)(-1/2) = -1/4。因此在极值点处的绝对值是1/4。在端点t=0和t=1时，g(t)=0。所以$|g(t)|的最大值是1/4，出现在t=1/2处。 因此，原表达式$(x - x_k)(x - x_{k+1})$的绝对值的最大值是$h^2 * 1/4 = h^2 /4$。 学生可能在这里有几个疑问点：变量替换是否正确，为什么选择这样的替换方式，以及如何确定函数的最大绝对值。可能需要详细解释每一步的转换，并验证替换的正确性。同时，强调二次函数的图像形状，开口方向，以及如何通过求导或对称性找到极值点。 另外，学生可能混淆了区间内的最大值和最小值，或者没有注意到绝对值的影响，所以需要明确指出在t=1/2处取得最大负值，绝对值最大。同时，确认在端点处函数值为零，不会成为最大值。 总结来说，这一步骤的关键在于通过变量替换将问题标准化，找到二次函数在区间内的绝对最大值，从而得到所需的上界$\frac{h^2}{4}$。 <end>已深度思考（用时38秒）</end> ```  为了推导不等式 $\left| (x - x_k)(x - x_{k+1}) \right| \le \frac{h^2}{4}$，我们分以下步骤分析： --- ### **1. 变量替换标准化** 设区间长度为 $h = x_{k+1} - x_k$，引入参数 $t \in [0,1]$，将任意点 $x \in [x_k, x_{k+1}]$ 表示为： $$ x = x_k + t h, \quad t \in [0,1]. $$ --- ### **2. 表达式转换** 将原式 $(x - x_k)(x - x_{k+1})$ 用 $t$ 表示： $$ \begin{aligned} (x - x_k)(x - x_{k+1})  &= (th) \cdot \big( x_k + th - (x_k + h) \big) \\ &= (th) \cdot (th - h) \\ &= h^2 t(t - 1). \end{aligned} $$ 因此，绝对值可写为： $$ \left| (x - x_k)(x - x_{k+1}) \right| = h^2 \cdot |t(t - 1)|. $$ --- ### **3. 求函数 $|t(t - 1)|$ 的最大值** 分析函数 $g(t) = t(t - 1)$ 在 $t \in [0,1]$ 内的极值： 1. **求导找极值点**：   $$   g'(t) = 2t - 1 \quad \Rightarrow \quad t = \frac{1}{2}.   $$ 2. **极值处函数值**：   $$   g\left(\frac{1}{2}\right) = \frac{1}{2} \cdot \left(\frac{1}{2} - 1\right) = -\frac{1}{4}.   $$ 3. **端点处函数值**：   $$   g(0) = 0, \quad g(1) = 0.   $$ 4. **最大绝对值**：   $$   \max_{t \in [0,1]} |g(t)| = \max\left\{ \left|-\frac{1}{4}\right|, |0|, |0| \right\} = \frac{1}{4}.   $$ --- ### **4. 代回原表达式** 由于 $\max |t(t - 1)| = \frac{1}{4}$，因此： $$ \left| (x - x_k)(x - x_{k+1}) \right| \le h^2 \cdot \frac{1}{4} = \frac{h^2}{4}. $$ --- ### **直观验证** - 当 $x$ 在区间中点（即 $t = \frac{1}{2}$）时，$(x - x_k)(x - x_{k+1})$ 达到最小值 $-\frac{h^2}{4}$，绝对值最大。 - 在端点 $x = x_k$ 或 $x = x_{k+1}$ 处，值为 $0$。 --- ### **结论** 通过变量替换和二次函数分析，证明了： $$ \left| (x - x_k)(x - x_{k+1}) \right| \le \frac{h^2}{4}. $$ 这一结果用于分段线性插值的余项估计，表明误差与子区间长度的平方成正比。
