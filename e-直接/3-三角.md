# 矩阵的三角分解

> [!warning]
>
> 方程组有唯一解

设有线性方程组
$$
\left\{\begin{matrix}
a_{11}x_1+a_{12}x_2+…+a_{1n}x_n=b_1 \\
a_{21}x_1+a_{22}x_2+…+a_{2n}x_n=b_2 \\
… \\
a_{m1}x_1+a_{m2}x_2+…+a_{mn}x_n=b_m
\end{matrix}\right.
$$
方程的矩阵形式
$$
\begin{pmatrix}
a_{11} & a_{12} & … & a_{1n} \\
a_{21} & a_{22} & … & a_{2n} \\
…  & … & … & … \\
a_{m1} & a_{m2} & … & a_{mn}
\end{pmatrix}
\begin{pmatrix}
x_1 \\
x_2 \\
… \\
x_n
\end{pmatrix}=
\begin{pmatrix}
b_1 \\
b_2 \\
… \\
b_n
\end{pmatrix}
$$
简写为
$$
Ax=b
$$
矩阵的分解是将矩阵拆解为数个矩阵的乘积，常见有

1. 三角分解法
2. QR分解法

如果矩阵$A=LU$，其中$L$为单位下三角矩阵，$U$为上三角矩阵，则：
$$
Ax=(LU)x=L(Ux)=b
$$
令$Ux=y$，则
$$
Ax=b \Leftrightarrow 
\left\{\begin{matrix}
Ux=y \\
Ly=b
\end{matrix}\right.
$$
求解过转换为

1. 根据方程$Ly=b$，求解向量$y$。
2. 根据方程$Ux=y$，求解$x$。

> [!warning]
>
> 由于$L$和$U$都是三角矩阵，所以求解的计算过程相对简单。

## LU分解定理

若非奇异矩阵$A$，经过一定的行变换后，可以分解成两个三角形矩阵的乘积，即
$$
A = LU
$$
其中
$$
L = 
\begin{pmatrix}
1      & 0      & 0      & \cdots & 0 \\
l_{21} & 1      & 0      & \cdots & 0 \\
l_{31} & l_{32} & 1      & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
l_{n1} & l_{n2} & l_{n3} & \cdots & 1
\end{pmatrix}
\quad
U =
\begin{pmatrix}
u_{11} & u_{12} & u_{13} & \cdots & u_{1n} \\
0      & u_{22} & u_{23} & \cdots & u_{2n} \\
0      & 0      & u_{33} & \cdots & u_{3n} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0      & 0      & 0      & \cdots & u_{nn}
\end{pmatrix}
$$
则称上述分解为杜立特尔（Doolittle）分解，也称LU分解。

> [!warning]
>
> 非奇异矩阵$\Leftrightarrow \det(A) \ne 0$

**定理**

若矩阵$A$非奇异，则$A$能分解为$L$和$U$的充分必要条件是$A$的顺序主子式不为0，即
$$
\begin{array}{lll} 
\Delta_1=a_{11}\ne 0 \\
\Delta_2=\begin{vmatrix}
a_{11} & a_{12} \\
a_{21} & a_{22} \\ 
\end{vmatrix} \ne 0 \\
… \\
\Delta_n=\begin{vmatrix}
a_{11} & … & a_{1n} \\
… & … & …\\
a_{n1} & … & a_{nn}  \\
\end{vmatrix} \ne 0
\end{array}
$$
若设$A$为$n$阶方阵，若$A$的顺序主子式$A_i$，$i=1,2,…,n-1$，均不为0，则矩阵$A$存在唯一的LU分解。

矩阵分解
$$
\begin{pmatrix}
a_{11} & a_{12} & a_{13}  & \cdots & a_{1n} \\
a_{21} & a_{22} & a_{23}  & \cdots & a_{2n} \\
a_{31} & a_{32} & a_{33}  & \cdots & a_{3n} \\
\vdots & \vdots & \vdots  & \ddots & \vdots \\
a_{n1} & a_{n2} & a_{n3}  & \cdots & a_{nn} \\
\end{pmatrix}
=
\begin{pmatrix}
1      & 0      & 0      & \cdots & 0 \\
l_{21} & 1      & 0      & \cdots & 0 \\
l_{31} & l_{32} & 1      & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
l_{n1} & l_{n2} & l_{n3} & \cdots & 1
\end{pmatrix}
\begin{pmatrix}
u_{11} & u_{12} & u_{13} & \cdots & u_{1n} \\
0      & u_{22} & u_{23} & \cdots & u_{2n} \\
0      & 0      & u_{33} & \cdots & u_{3n} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0      & 0      & 0      & \cdots & u_{nn}
\end{pmatrix}
$$
由矩阵的乘法规则，比较两端的第一行、第一列可得
$$
a_{ij}=u_{ij} \quad j=1,2, \cdots, n
$$
对于矩阵$A$第二行有
$$
a_{21}=l_{21}u_{11}
$$
对于第一列元素有
$$
a_{i1}=l_{i1}u_{11}
$$
所以有
$$
l_{i1}=\frac{a_{i1}}{u_{11}}
$$
根据上述过程可以得到第一行和第一列元素。计算第二行剩余元素有，
$$
a_{22}=l_{21}u_{12}+u_{22}
$$
其中$l_{21}$和$u_{12}$已知，所以有
$$
u_{22}=a_{22}-l_{21}u_{12}
$$
所以第二行胜于元素的一般计算公式为
$$
u_{2j}=a_{2j}-l_{21}u_{1j} \quad j=2,3, \cdots, n
$$


